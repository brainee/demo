@using System.Configuration;
<script type="text/lizard-config">
{
  url_schema: '/restful/dependent',
  viewName: 'restfulDependent',
  model:{
    apis: [
    {
      name: 'api2',
      url: '@ConfigurationManager.AppSettings["restfullApi"]detail/api2',
      postdata: {
        id: Lizard.P('id'),
        key: Lizard.P('key')
      }
    },
    {
      name: 'api3',
      url: '@ConfigurationManager.AppSettings["restfullApi"]detail/api3',
      postdata: {
        id: Lizard.P('id'),
        key: Lizard.P('key')
      },
      //\u63A7\u5236api3\u7684\u8BF7\u6C42\u662F\u5426\u53D1\u51FA\uFF0C\u8FD4\u56DEtrue\u662F\u53D1\u51FA\u8BF7\u6C42
      suspend: function() {
           var api2 = Lizard.D('api2'); //lizard.D\u8BF7\u6C42\u4F9D\u8D56\u6A21\u5757\uFF0C\u8FD4\u56DE\u7684\u662Fapi2\u7684\u63A5\u53E3\u7684\u6570\u636E
           var list = api2.list;
           return list[0].room < 4; //api2\u8BF7\u6C42\u5317\u4EAC\u7684\u9152\u5E97\uFF0C\u5982\u679C\u9152\u5E97\u6570\u76EE\u5C0F\u4E8E4\uFF0C\u5C31\u8BF7\u6C42api3
      }
    }],
    filter: function(datas) {
       var list = [];
       _.each(datas, function(item) {
         if (!item.list) return;
         item.list[0]['key'] = item.key;
         list = list.concat(item.list);
       });
       return {
         list: list
       };
    }
  },
  view:{
    viewport: Lizard.T("viewportTmpl")
  },
  controller: '/webapp/demo2.1/webresource/controllers/restful/dependent.js'
}
</script>
<script id="viewportTmpl" type="text/lizard-template">
  <div>
    <ul>
      <% _.each(list, function(item) { %>
      <li>
        key: <%= item.key %>
        id: <%= item.id %>
        city: <%= item.city %>
      </li>
      <% }) %>
    </ul>
  </div>
</script>